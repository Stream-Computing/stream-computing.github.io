<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-希姆计算软件产品/STCRP使用指南/stcqual使用指南" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.1">
<title data-rh="true">stcqual使用指南 | 文档中心</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://your-docusaurus-site.example.com/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://your-docusaurus-site.example.com/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://your-docusaurus-site.example.com/docs/希姆计算软件产品/STCRP使用指南/stcqual使用指南"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="stcqual使用指南 | 文档中心"><meta data-rh="true" name="description" content="stcqual概述"><meta data-rh="true" property="og:description" content="stcqual概述"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://your-docusaurus-site.example.com/docs/希姆计算软件产品/STCRP使用指南/stcqual使用指南"><link data-rh="true" rel="alternate" href="https://your-docusaurus-site.example.com/docs/希姆计算软件产品/STCRP使用指南/stcqual使用指南" hreflang="en"><link data-rh="true" rel="alternate" href="https://your-docusaurus-site.example.com/docs/希姆计算软件产品/STCRP使用指南/stcqual使用指南" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"stcqual使用指南","item":"https://your-docusaurus-site.example.com/docs/希姆计算软件产品/STCRP使用指南/stcqual使用指南"}]}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="文档中心 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="文档中心 Atom Feed"><link rel="stylesheet" href="/assets/css/styles.59b7a052.css">
<script src="/assets/js/runtime~main.462312d6.js" defer="defer"></script>
<script src="/assets/js/main.327d30a9.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/stc_logo.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/stc_logo.svg" alt="" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/stc_logo.svg" alt="" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">STC DOCS HUB</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/intro">文档</a><a class="navbar__item navbar__link" href="/blog">动态</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://www.streamcomputing.com/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">希姆计算<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro"><span title="Tutorial Intro" class="linkLabel_WmDU">Tutorial Intro</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/docs/category/tutorial---basics"><span title="Tutorial - Basics" class="categoryLinkLabel_W154">Tutorial - Basics</span></a><button aria-label="Expand sidebar category &#x27;Tutorial - Basics&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/docs/category/tutorial---extras"><span title="Tutorial - Extras" class="categoryLinkLabel_W154">Tutorial - Extras</span></a><button aria-label="Expand sidebar category &#x27;Tutorial - Extras&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/希姆计算产品运维/k8s-device-plugin使用指南"><span title="希姆计算产品运维" class="categoryLinkLabel_W154">希姆计算产品运维</span></a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/希姆计算介绍"><span title="希姆计算" class="linkLabel_WmDU">希姆计算</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/希姆计算开发者资源/C++ API"><span title="希姆计算开发者资源" class="categoryLinkLabel_W154">希姆计算开发者资源</span></a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/希姆计算术语表"><span title="希姆计算术语表" class="linkLabel_WmDU">希姆计算术语表</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/希姆计算硬件产品/STCP920产品手册"><span title="希姆计算硬件产品" class="categoryLinkLabel_W154">希姆计算硬件产品</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/希姆计算解决方案/希姆算力云平台解决方案"><span title="希姆计算解决方案" class="categoryLinkLabel_W154">希姆计算解决方案</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/docs/希姆计算软件产品/Firmware Release Notes"><span title="希姆计算软件产品" class="categoryLinkLabel_W154">希姆计算软件产品</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/希姆计算软件产品/Firmware Release Notes"><span title="Firmware Release Notes" class="linkLabel_WmDU">Firmware Release Notes</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/希姆计算软件产品/STCRP Release Notes"><span title="STCRP Release Notes" class="linkLabel_WmDU">STCRP Release Notes</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/希姆计算软件产品/STCRP产品简介"><span title="STCRP产品简介" class="linkLabel_WmDU">STCRP产品简介</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/docs/希姆计算软件产品/STCRP使用指南/HPE使用指南"><span title="STCRP使用指南" class="categoryLinkLabel_W154">STCRP使用指南</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/希姆计算软件产品/STCRP使用指南/HPE使用指南"><span title="HPE使用指南" class="linkLabel_WmDU">HPE使用指南</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/希姆计算软件产品/STCRP使用指南/MLTC使用指南"><span title="MLTC使用指南" class="linkLabel_WmDU">MLTC使用指南</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/希姆计算软件产品/STCRP使用指南/STC_LLM使用指南"><span title="STC_LLM使用指南" class="linkLabel_WmDU">STC_LLM使用指南</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/希姆计算软件产品/STCRP使用指南/npu-exporter使用说明"><span title="npu-exporter使用说明" class="linkLabel_WmDU">npu-exporter使用说明</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/希姆计算软件产品/STCRP使用指南/stcqual使用指南"><span title="stcqual使用指南" class="linkLabel_WmDU">stcqual使用指南</span></a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/希姆计算软件产品/STCRP安装指南"><span title="STCRP安装指南" class="linkLabel_WmDU">STCRP安装指南</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/希姆计算软件产品/固件更新指南"><span title="固件更新指南" class="linkLabel_WmDU">固件更新指南</span></a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">希姆计算软件产品</span></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">STCRP使用指南</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">stcqual使用指南</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>stcqual使用指南</h1></header>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="stcqual概述">stcqual概述<a href="#stcqual概述" class="hash-link" aria-label="Direct link to stcqual概述" title="Direct link to stcqual概述" translate="no">​</a></h2>
<p>stcqual用于验证希姆计算NPU设备的功能和性能，支持测试PCIe带宽、DDR带宽、NPU算力、板卡功耗等，以及全面的系统级测试，并对应提供了测试用例。</p>
<p>本文中会提及以下驱动：</p>
<ul>
<li>stcdma.ko：stcqual提供的驱动，用于支持PCIe带宽测试。</li>
<li>stcqual stc.ko：stcqual提供的驱动，用于支持除PCIe带宽以外的其他测试。</li>
<li>standard stc.ko：HPE提供的驱动，是希姆计算异构编程环境包括的模块之一。</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="使用stcqual测试npu设备">使用stcqual测试NPU设备<a href="#使用stcqual测试npu设备" class="hash-link" aria-label="Direct link to 使用stcqual测试NPU设备" title="Direct link to 使用stcqual测试NPU设备" translate="no">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="前提条件">前提条件<a href="#前提条件" class="hash-link" aria-label="Direct link to 前提条件" title="Direct link to 前提条件" translate="no">​</a></h3>
<ul>
<li>
<p>主机配置满足以下要求：</p>
<ul>
<li>Intel/AMD的64位CPU。</li>
<li>系统内存大小不低于2GiB。</li>
</ul>
</li>
<li>
<p>联系希姆计算技术支持获取stcqual工具包。</p>
</li>
<li>
<p>推荐以root用户登录主机，使用stcqual时需要访问一些系统目录。</p>
</li>
<li>
<p>主机已安装依赖包，以Ubuntu为例：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ sudo apt-get install bc vim-common numactl </span><br></span></code></pre></div></div>
</li>
<li>
<p>主机已安装编译C/C++程序所需的工具包，以Ubuntu为例：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ sudo apt-get install make</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ sudo apt-get install build-essential</span><br></span></code></pre></div></div>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="使用流程">使用流程<a href="#使用流程" class="hash-link" aria-label="Direct link to 使用流程" title="Direct link to 使用流程" translate="no">​</a></h3>
<p>以stcqual V1.3.14为例，使用流程如下：</p>
<ol>
<li>
<p>停止运行任何依赖HPE驱动的程序。在使用stcqual之前，NPU设备必须处于初始状态。
执行<code>lsmod | grep stc</code>命令查看正在依赖HPE驱动的程序。示例如下，stc模块正在被48个其他模块依赖。</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ lsmod | grep stc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">stc                   512000  48</span><br></span></code></pre></div></div>
</li>
<li>
<p>如果存在依赖HPE驱动的程序，可以执行<code>stc-smi</code>命令查看程序的Pid，然后视情况等待程序执行完成或者自行终止程序。</p>
</li>
<li>
<p>解压stcqual工具包并进入工具目录。以工具包名称为stcqual-v1.3.14-5a1b688.tar.gz为例，工具目录中包含了若干目录和文件。</p>
<div class="language-Bash language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ tar -zxvf stcqual-v1.3.14-5a1b688.tar.gz</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ cd stcqual</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ ls</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">build_info    npc_load.sh    npu.ddr_stress.sh  npu.slt.sh      pcie_common.sh  result                       system_prepare.sh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cases         npc_run.sh     npu.pcie_bw.sh     npu.thermal.sh  pub_key         stcqual                      tools</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">driver        npu.ai_net.sh  npu.pcie_eye.sh    npu.tops.sh     pvtdef.sh       stcqual.thermal.parallel.sh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">npc_clean.sh  npu.ddr_bw.sh  npu.power.sh       packages        README.md       switch_freq.sh</span><br></span></code></pre></div></div>
</li>
<li>
<p>选择测试时需要使用的内核驱动。stcqual单独提供了用于支持测试的驱动，而非使用HPE驱动，因此在执行测试前需要使用system_prepare.sh脚本切换驱动。</p>
<blockquote>
<p>说明：首次切换stcdma.ko或stcqual stc.ko时，会进行自动编译，下方示例简化了过程中输出的回显信息，看到DONE即代表编译完成。如果您需要重新编译驱动，可以删除./result目录下的stcdma.ko或stc.ko文件，然后重新运行system_prepare.sh脚本。</p>
</blockquote>
<ul>
<li>
<p>切换stcdma.ko：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ ./system_prepare.sh 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Check numactl commands on this host...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Remove standard stc.ko ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Load stcdma.ko to kernel...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DONE</span><br></span></code></pre></div></div>
</li>
<li>
<p>切换stcqual stc.ko：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ ./system_prepare.sh 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Remove stcdma.ko ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Load stcqual stc.ko to kernel...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DONE</span><br></span></code></pre></div></div>
</li>
</ul>
</li>
<li>
<p>执行测试。stcqual为PCIe带宽、DDR带宽、NPU算力、板卡功耗、系统级测试等提供了测试用例，您可以通过命令方便地选择测试用例，详细说明，请参见<em>命令说明</em>和<em>命令示例</em>章节。测试完成后，会自动在log目录下生成日志文件。</p>
<blockquote>
<p>注意：部分测试可能耗时较长，例如系统级测试耗时约10分钟。在测试过程中请不要通过Ctrl+C等方式强制退出，否则会导致系统不稳定。</p>
</blockquote>
</li>
<li>
<p>完成测试后，切换回HPE驱动，恢复NPU设备至正常工作状态。</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ sudo rmmod stc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ sudo modprobe stc </span><br></span></code></pre></div></div>
</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="文件说明">文件说明<a href="#文件说明" class="hash-link" aria-label="Direct link to 文件说明" title="Direct link to 文件说明" translate="no">​</a></h3>
<p>stcqual工具目录中包含了若干目录和文件，建议您关注的目录和文件如下：</p>
<table><thead><tr><th><strong>名称</strong></th><th><strong>类型</strong></th><th><strong>描述</strong></th><th><strong>文件示例</strong></th></tr></thead><tbody><tr><td>log</td><td>目录</td><td>在执行测试时自动生成的目录，保存测试过程中产生的日志。</td><td>/stcqual/log/npu0-work/stcqual-slt-npu0-00P8K2860206090d-stc920-202209161634.log</td></tr><tr><td>result</td><td>目录</td><td>保存测试结果文件，例如DDR压力测试过程中输出的bin文件。</td><td>/stcqual/result/npu0/npu0_ddr0_output_random.bin</td></tr><tr><td>stcqual</td><td>文件</td><td>使用stcqual工具的入口，支持通过选项选择测试用例、输出形式等。</td><td>stcqual</td></tr><tr><td>system_prepare.sh</td><td>文件</td><td>用于切换驱动的脚本。</td><td>system_prepare.sh</td></tr><tr><td>README.md</td><td>文件</td><td>stcqual工具的使用说明。</td><td>README.md</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="命令说明">命令说明<a href="#命令说明" class="hash-link" aria-label="Direct link to 命令说明" title="Direct link to 命令说明" translate="no">​</a></h3>
<p>执行<code>./stcqual -h</code>获取stcqual命令的使用方法：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ cd stcqual</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ ./stcqual -h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">STCQual - A qualify toolset for StreamComputing NPU product.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Option list：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -h, --help:                Print usage</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -v, --version:             STCQual version info</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -l, --list:                Show list of currently detected NPUs on the host.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -t, --test:                Specify the test to be run [1-8]. Default value is 8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -p, --pcibus:              Specify the PCI Slot bus ID for the test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -i, --index:               Specify the NPU ID for the test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      --loops:               Provide number of loops for specified test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      --prod_id:             Provide product id for log file</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      --prod_type:           Provide product type for stcqual test: [920, 908]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      --cust_time:           Provide a customized timestamp for log file</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      --high_temp_warn:      Specify a customized high temperature warning threshold</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Test list:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        [1]  PCIe bandwidth test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        [2]  PCIe eye data test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        [3]  DDR bandwidth test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        [4]  Computing power (TOPS) test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        [5]  AI net performance test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        [6]  Thermal test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        [7]  Power test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        [8]  System Level Test (SLT) - sequence order</span><br></span></code></pre></div></div>
<p>stcqual命令支持以下选项：</p>
<table><thead><tr><th><strong>选项</strong></th><th><strong>描述</strong></th></tr></thead><tbody><tr><td><code>-h, --help</code></td><td>查看stcqual支持的选项和测试集。</td></tr><tr><td><code>-v, --version</code></td><td>查看stcqual的版本信息。</td></tr><tr><td><code>-l, --list</code></td><td>查看主机中检测到的NPU设备。</td></tr><tr><td><code>-t, --test</code></td><td>通过编号指定测试集，默认值为8。取值范围为1~8。</td></tr><tr><td><code>-p, --pcibus</code></td><td>在使用指定PCI总线的NPU设备上执行测试。</td></tr><tr><td><code>-i, --index</code></td><td>在指定NPU上执行测试。</td></tr><tr><td><code>--loops</code></td><td>指定循环测试的次数，默认值为1。</td></tr><tr><td><code>--prod_id</code></td><td>生成日志文件时，在文件名中添加自定义信息。</td></tr><tr><td><code>--prod_type</code></td><td>用于指定产品类型，默认为920，产品类型会影响测试时使用的时钟频率。取值范围：<br>920：代表STCP920，测试时使用的时钟频率为1000M。<br>908：代表STCP908，测试时使用的时钟频率为900M。</td></tr><tr><td><code>--cust_time</code></td><td>生成日志文件时，在文件名中添加指定的时间戳。</td></tr><tr><td><code>--high_temp_warn</code></td><td>在板卡温度超过温度阈值时会触发高温警告并停止测试，默认情况下，用户版stcqual的温度阈值为90℃，工厂版stcqual的温度阈值为80℃。您可以通过该参数自定义温度阈值。<br>说明：仅支持在用户版stcqual使用该参数。此外，仅test case 5<del>8中会检测板卡温度，因此仅test case 5</del>8中该参数才会生效。</td></tr></tbody></table>
<p>stcqual支持以下测试集：</p>
<table><thead><tr><th><strong>测试集编号</strong></th><th><strong>测试集名称</strong></th><th><strong>描述</strong></th></tr></thead><tbody><tr><td>1</td><td>PCIe bandwidth test</td><td>PCIe带宽测试，通过PCIe DMA通道在主机端内存和设备端内存之间传输数据，根据传输的最大数据量和传输时间计算出PCIe的带宽。</td></tr><tr><td>2</td><td>PCIe eye data test</td><td>PCIe眼图数据测试，逐个lane打印眼图数据，并根据若干个检测点，汇总判断眼图质量是否满足要求。</td></tr><tr><td>3</td><td>DDR bandwidth test</td><td>DDR带宽测试，通过NPU内部的sysDMA通道在设备端DDR与LLB之间传输数据，根据传输的最大数据量和传输时间（基于clock数）计算出DDR的带宽。</td></tr><tr><td>4</td><td>Computing power (TOPS) test</td><td>NPU算力测试，运行指定的MAC运算，根据运算消耗的时间（基于clock数）评估NPU的算力。</td></tr><tr><td>5</td><td>AI Net performance test</td><td>AI网络性能测试，顺序执行ResNet50、ResNet50 INT8、BERT，根据执行各个网络时所处理的数据量和消耗的时间，计算出在NPU上执行AI网络的性能。</td></tr><tr><td>6</td><td>Thermal test</td><td>发热测试，在所有NPU上运行高功耗用例，后台线程定期轮询板卡温度。检测到温度过高时，则记录一次error到结果文件。</td></tr><tr><td>7</td><td>Power test</td><td>功耗测试，在后台运行高功耗用例，并在前台监控功耗状况。</td></tr><tr><td>8</td><td>System Level Test (SLT) - sequence order</td><td>系统级测试（SLT），顺序执行10项测试，全面验证NPU的功能和性能，包括scan_sram、ddr_stress、pld、sdma、l1_im、mac、mac_x8、resnet50_x8、resnet50、bert。</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="命令示例">命令示例<a href="#命令示例" class="hash-link" aria-label="Direct link to 命令示例" title="Direct link to 命令示例" translate="no">​</a></h3>
<p>以stcqual V1.3.14为例，演示几类命令的执行结果。</p>
<blockquote>
<p>说明：大部分命令回显信息较多，因此示例仅展示部分回显信息。</p>
</blockquote>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="查看npu设备">查看NPU设备<a href="#查看npu设备" class="hash-link" aria-label="Direct link to 查看NPU设备" title="Direct link to 查看NPU设备" translate="no">​</a></h4>
<p>查看主机中检测到的NPU设备，回显内容和驱动类型有关：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ ./system_prepare.sh 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Remove stcdma.ko ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Load stcqual stc.ko to kernel...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DONE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ ./stcqual --list</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NPU: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        STCP920         BUS-ID: 0:03:00.0 (01PSF600000d0709)</span><br></span></code></pre></div></div>
<p>示例为检测到一个NPU设备，产品类型为STCP920，NPU设备所使用PCI总线的ID为<code>0:03:00.0</code>。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="在所有npu上测试">在所有NPU上测试<a href="#在所有npu上测试" class="hash-link" aria-label="Direct link to 在所有NPU上测试" title="Direct link to 在所有NPU上测试" translate="no">​</a></h4>
<p>在所有NPU上执行PCIe眼图数据测试：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ ./system_prepare.sh 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">stcqual stc.ko is already loaded...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ ./stcqual --test 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">stcqual version:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">stcqual version: v1.3.14</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">HOST SYSTEM INFO:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Architecture:                    x86_64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CPU op-mode(s):                  32-bit, 64-bit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Byte Order:                      Little Endian</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Address sizes:                   40 bits physical, 48 bits virtual</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CPU(s):                          8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">On-line CPU(s) list:             0-7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Thread(s) per core:              1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Core(s) per socket:              1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Socket(s):                       8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NUMA node(s):                    1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Vendor ID:                       AuthenticAMD</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CPU family:                      23</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Model:                           49</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Model name:                      AMD EPYC-Rome Processor</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Stepping:                        0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CPU MHz:                         2794.748</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">BogoMIPS:                        5589.49</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Virtualization:                  AMD-V</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Hypervisor vendor:               KVM</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Virtualization type:             full</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">L1d cache:                       256 KiB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">L1i cache:                       256 KiB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">L2 cache:                        4 MiB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">L3 cache:                        128 MiB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NUMA node0 CPU(s):               0-7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Vulnerability Itlb multihit:     Not affected</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Vulnerability L1tf:              Not affected</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Vulnerability Mds:               Not affected</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Vulnerability Meltdown:          Not affected</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Vulnerability Spec store bypass: Mitigation; Speculative Store Bypass disabled via prctl and seccomp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Vulnerability Spectre v1:        Mitigation; usercopy/swapgs barriers and __user pointer sanitization</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Vulnerability Spectre v2:        Mitigation; LFENCE, IBPB conditional, IBRS_FW, STIBP disabled, RSB filling</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Vulnerability Srbds:             Not affected</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Vulnerability Tsx async abort:   Not affected</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Flags:                           fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush mmx fxsr sse sse2 syscall nx mmxext fxsr_opt pdpe1gb rdtscp lm rep_good nopl cpuid extd_apicid tsc_known_freq pni pclmulqdq ssse3 fma cx16 sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand hypervisor lahf_lm cmp_legacy svm cr8_legacy abm sse4a misalignsse 3dnowprefetch osvw topoext perfctr_core ssbd ibrs ibpb stibp vmmcall fsgsbase tsc_adjust bmi1 avx2 smep bmi2 rdseed adx smap clflushopt clwb sha_ni xsaveopt xsavec xgetbv1 clzero xsaveerptr wbnoinvd arat npt nrip_save umip rdpid arch_capabilities</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Current test is running on NPU0:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NPU: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Product name: STCP920</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Product brand: STREAMCOMPUTING</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Sn: 01PSF60000170610</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Chip count: 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Temperature:   33C</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        AlertTemperature:   90C</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ShutdownTemperature:   90C</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Status: on</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Power:   31W</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Cluster count: 4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Frequency: 1000M</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Bus: 0000:03:00.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Vendor: 23e2 Device: 0100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Current link speed: 16.0 GT/s PCIe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Max link speed: 16.0 GT/s PCIe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Current link width: 16</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Max link width: 16</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Write bytes: 0B</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">stc device voltage info vsoc:840 mv vmac:720 mv</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">stc device soc west frequency 1000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">stc device soc east frequency 1000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">stc device ddr frequency 3733</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">################################################################</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               STCP920 [pcie_eye] TEST ON NPU0 BEGIN</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#################################################################</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="在指定npu上测试">在指定NPU上测试<a href="#在指定npu上测试" class="hash-link" aria-label="Direct link to 在指定NPU上测试" title="Direct link to 在指定NPU上测试" translate="no">​</a></h4>
<ul>
<li>
<p>在NPU 0上执行PCIe带宽测试：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ ./system_prepare.sh 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Check numactl commands on this host...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Remove stcqual stc.ko ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Load stcdma.ko to kernel...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DONE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ ./stcqual --test 1 --index 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">stcqual version:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">stcqual version: v1.3.14</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">HOST SYSTEM INFO:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Architecture:                    x86_64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CPU op-mode(s):                  32-bit, 64-bit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Byte Order:                      Little Endian</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Address sizes:                   40 bits physical, 48 bits virtual</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CPU(s):                          8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">On-line CPU(s) list:             0-7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Thread(s) per core:              1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Core(s) per socket:              1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Socket(s):                       8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NUMA node(s):                    1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Vendor ID:                       AuthenticAMD</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CPU family:                      23</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Model:                           49</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Model name:                      AMD EPYC-Rome Processor</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Stepping:                        0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CPU MHz:                         2794.748</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">BogoMIPS:                        5589.49</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Virtualization:                  AMD-V</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Hypervisor vendor:               KVM</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Virtualization type:             full</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">L1d cache:                       256 KiB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">L1i cache:                       256 KiB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">L2 cache:                        4 MiB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">L3 cache:                        128 MiB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NUMA node0 CPU(s):               0-7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Vulnerability Itlb multihit:     Not affected</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Vulnerability L1tf:              Not affected</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Vulnerability Mds:               Not affected</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Vulnerability Meltdown:          Not affected</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Vulnerability Spec store bypass: Mitigation; Speculative Store Bypass disabled via prctl and seccomp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Vulnerability Spectre v1:        Mitigation; usercopy/swapgs barriers and __user pointer sanitization</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Vulnerability Spectre v2:        Mitigation; LFENCE, IBPB conditional, IBRS_FW, STIBP disabled, RSB filling</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Vulnerability Srbds:             Not affected</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Vulnerability Tsx async abort:   Not affected</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Flags:                           fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush mmx fxsr sse sse2 syscall nx mmxext fxsr_opt pdpe1gb rdtscp lm rep_good nopl cpuid extd_apicid tsc_known_freq pni pclmulqdq ssse3 fma cx16 sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand hypervisor lahf_lm cmp_legacy svm cr8_legacy abm sse4a misalignsse 3dnowprefetch osvw topoext perfctr_core ssbd ibrs ibpb stibp vmmcall fsgsbase tsc_adjust bmi1 avx2 smep bmi2 rdseed adx smap clflushopt clwb sha_ni xsaveopt xsavec xgetbv1 clzero xsaveerptr wbnoinvd arat npt nrip_save umip rdpid arch_capabilities</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Current test is running on NPU0:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">################################################################</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               STCP920 [pcie_bw] TEST ON NPU0 BEGIN</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#################################################################</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span></code></pre></div></div>
</li>
<li>
<p>在NPU 0上执行PCIe眼图数据测试：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ ./system_prepare.sh 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Remove stcdma.ko ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Load stcqual stc.ko to kernel...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DONE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ ./stcqual --test 2 --index 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">stcqual version:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">stcqual version: v1.3.14</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">HOST SYSTEM INFO:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Architecture:                    x86_64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CPU op-mode(s):                  32-bit, 64-bit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Byte Order:                      Little Endian</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Address sizes:                   40 bits physical, 48 bits virtual</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CPU(s):                          8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">On-line CPU(s) list:             0-7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Thread(s) per core:              1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Core(s) per socket:              1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Socket(s):                       8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NUMA node(s):                    1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Vendor ID:                       AuthenticAMD</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CPU family:                      23</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Model:                           49</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Model name:                      AMD EPYC-Rome Processor</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Stepping:                        0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CPU MHz:                         2794.750</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">BogoMIPS:                        5589.50</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Virtualization:                  AMD-V</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Hypervisor vendor:               KVM</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Virtualization type:             full</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">L1d cache:                       256 KiB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">L1i cache:                       256 KiB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">L2 cache:                        4 MiB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">L3 cache:                        128 MiB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NUMA node0 CPU(s):               0-7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Vulnerability Itlb multihit:     Not affected</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Vulnerability L1tf:              Not affected</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Vulnerability Mds:               Not affected</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Vulnerability Meltdown:          Not affected</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Vulnerability Spec store bypass: Mitigation; Speculative Store Bypass disabled via prctl and seccomp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Vulnerability Spectre v1:        Mitigation; usercopy/swapgs barriers and __user pointer sanitization</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Vulnerability Spectre v2:        Mitigation; LFENCE, IBPB conditional, IBRS_FW, STIBP disabled, RSB filling</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Vulnerability Srbds:             Not affected</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Vulnerability Tsx async abort:   Not affected</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Flags:                           fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush mmx fxsr sse sse2 syscall nx mmxext fxsr_opt pdpe1gb rdtscp lm rep_good nopl cpuid extd_apicid tsc_known_freq pni pclmulqdq ssse3 fma cx16 sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand hypervisor lahf_lm cmp_legacy svm cr8_legacy abm sse4a misalignsse 3dnowprefetch osvw topoext perfctr_core ssbd ibrs ibpb stibp vmmcall fsgsbase tsc_adjust bmi1 avx2 smep bmi2 rdseed adx smap clflushopt clwb sha_ni xsaveopt xsavec xgetbv1 clzero xsaveerptr wbnoinvd arat npt nrip_save umip rdpid arch_capabilities</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Current test is running on NPU0:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NPU: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Product name: STCP920</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Product brand: STREAMCOMPUTING</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Sn: 01PSF60000170610</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Chip count: 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Temperature:   34C</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        AlertTemperature:   90C</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ShutdownTemperature:   90C</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Status: on</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Power:   31W</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Cluster count: 4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Frequency: 1000M</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Bus: 0000:03:00.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Vendor: 23e2 Device: 0100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Current link speed: 16.0 GT/s PCIe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Max link speed: 16.0 GT/s PCIe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Current link width: 16</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Max link width: 16</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Write bytes: 0B</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">stc device voltage info vsoc:840 mv vmac:720 mv</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">stc device soc west frequency 1000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">stc device soc east frequency 1000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">stc device ddr frequency 3733</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">################################################################</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               STCP920 [pcie_eye] TEST ON NPU0 BEGIN</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#################################################################</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span></code></pre></div></div>
</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="在使用指定pci总线的npu上执行测试">在使用指定PCI总线的NPU上执行测试<a href="#在使用指定pci总线的npu上执行测试" class="hash-link" aria-label="Direct link to 在使用指定PCI总线的NPU上执行测试" title="Direct link to 在使用指定PCI总线的NPU上执行测试" translate="no">​</a></h4>
<p>在使用指定PCI总线（地址为<code>0:03:00.0</code>）的NPU上执行DDR带宽测试：</p>
<blockquote>
<p>说明：如果使用<code>./stcqual --list</code>得到的BUS-ID，无需包括末尾（例如<code>(01P9MV530002030a)</code>），否则会出现报错。</p>
</blockquote>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ ./system_prepare.sh 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">stcqual stc.ko is already loaded...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ ./stcqual --list</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NPU: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        STCP920         BUS-ID: 0:03:00.0 (01PSF600000d0709)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ ./stcqual --test 3 --pcibus 0:03:00.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Convert pci_bus_id: 0000:03:00.0 to npu_id: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">stcqual version:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">stcqual version: v1.3.14</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">HOST SYSTEM INFO:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Architecture:                    x86_64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CPU op-mode(s):                  32-bit, 64-bit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Byte Order:                      Little Endian</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Address sizes:                   40 bits physical, 48 bits virtual</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CPU(s):                          8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">On-line CPU(s) list:             0-7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Thread(s) per core:              1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Core(s) per socket:              1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Socket(s):                       8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NUMA node(s):                    1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Vendor ID:                       AuthenticAMD</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CPU family:                      23</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Model:                           49</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Model name:                      AMD EPYC-Rome Processor</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Stepping:                        0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CPU MHz:                         2794.748</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">BogoMIPS:                        5589.49</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Virtualization:                  AMD-V</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Hypervisor vendor:               KVM</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Virtualization type:             full</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">L1d cache:                       256 KiB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">L1i cache:                       256 KiB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">L2 cache:                        4 MiB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">L3 cache:                        128 MiB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NUMA node0 CPU(s):               0-7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Vulnerability Itlb multihit:     Not affected</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Vulnerability L1tf:              Not affected</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Vulnerability Mds:               Not affected</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Vulnerability Meltdown:          Not affected</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Vulnerability Spec store bypass: Mitigation; Speculative Store Bypass disabled via prctl and seccomp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Vulnerability Spectre v1:        Mitigation; usercopy/swapgs barriers and __user pointer sanitization</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Vulnerability Spectre v2:        Mitigation; LFENCE, IBPB conditional, IBRS_FW, STIBP disabled, RSB filling</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Vulnerability Srbds:             Not affected</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Vulnerability Tsx async abort:   Not affected</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Flags:                           fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush mmx fxsr sse sse2 syscall nx mmxext fxsr_opt pdpe1gb rdtscp lm rep_good nopl cpuid extd_apicid tsc_known_freq pni pclmulqdq ssse3 fma cx16 sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand hypervisor lahf_lm cmp_legacy svm cr8_legacy abm sse4a misalignsse 3dnowprefetch osvw topoext perfctr_core ssbd ibrs ibpb stibp vmmcall fsgsbase tsc_adjust bmi1 avx2 smep bmi2 rdseed adx smap clflushopt clwb sha_ni xsaveopt xsavec xgetbv1 clzero xsaveerptr wbnoinvd arat npt nrip_save umip rdpid arch_capabilities</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Current test is running on NPU0:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NPU: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Product name: STCP920</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Product brand: STREAMCOMPUTING</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Sn: 01PSF60000170610</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Chip count: 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Temperature:   33C</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        AlertTemperature:   90C</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ShutdownTemperature:   90C</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Status: on</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Power:   31W</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Cluster count: 4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Frequency: 1000M</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Bus: 0000:03:00.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Vendor: 23e2 Device: 0100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Current link speed: 16.0 GT/s PCIe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Max link speed: 16.0 GT/s PCIe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Current link width: 16</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Max link width: 16</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Write bytes: 0B</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">stc device voltage info vsoc:840 mv vmac:720 mv</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">stc device soc west frequency 1000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">stc device soc east frequency 1000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">stc device ddr frequency 3733</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">################################################################</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               STCP920 [ddr_bw] TEST ON NPU0 BEGIN</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#################################################################</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="自定义温度阈值">自定义温度阈值<a href="#自定义温度阈值" class="hash-link" aria-label="Direct link to 自定义温度阈值" title="Direct link to 自定义温度阈值" translate="no">​</a></h4>
<p>执行发热测试并设置温度阈值为50℃：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ ./system_prepare.sh 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">stcqual stc.ko is already loaded...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ ./stcqual --test 6 --high_temp_warn 50</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">stcqual version:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">stcqual version: v1.3.14</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">HOST SYSTEM INFO:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Architecture:                    x86_64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CPU op-mode(s):                  32-bit, 64-bit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Byte Order:                      Little Endian</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Address sizes:                   40 bits physical, 48 bits virtual</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CPU(s):                          8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">On-line CPU(s) list:             0-7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Thread(s) per core:              1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Core(s) per socket:              1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Socket(s):                       8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NUMA node(s):                    1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Vendor ID:                       AuthenticAMD</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CPU family:                      23</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Model:                           49</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Model name:                      AMD EPYC-Rome Processor</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Stepping:                        0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CPU MHz:                         2794.748</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">BogoMIPS:                        5589.49</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Virtualization:                  AMD-V</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Hypervisor vendor:               KVM</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Virtualization type:             full</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">L1d cache:                       256 KiB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">L1i cache:                       256 KiB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">L2 cache:                        4 MiB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">L3 cache:                        128 MiB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NUMA node0 CPU(s):               0-7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Vulnerability Itlb multihit:     Not affected</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Vulnerability L1tf:              Not affected</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Vulnerability Mds:               Not affected</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Vulnerability Meltdown:          Not affected</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Vulnerability Spec store bypass: Mitigation; Speculative Store Bypass disabled via prctl and seccomp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Vulnerability Spectre v1:        Mitigation; usercopy/swapgs barriers and __user pointer sanitization</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Vulnerability Spectre v2:        Mitigation; LFENCE, IBPB conditional, IBRS_FW, STIBP disabled, RSB filling</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Vulnerability Srbds:             Not affected</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Vulnerability Tsx async abort:   Not affected</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Flags:                           fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush mmx fxsr sse sse2 syscall nx mmxext fxsr_opt pdpe1gb rdtscp lm rep_good nopl cpuid extd_apicid tsc_known_freq pni pclmulqdq ssse3 fma cx16 sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand hypervisor lahf_lm cmp_legacy svm cr8_legacy abm sse4a misalignsse 3dnowprefetch osvw topoext perfctr_core ssbd ibrs ibpb stibp vmmcall fsgsbase tsc_adjust bmi1 avx2 smep bmi2 rdseed adx smap clflushopt clwb sha_ni xsaveopt xsavec xgetbv1 clzero xsaveerptr wbnoinvd arat npt nrip_save umip rdpid arch_capabilities</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Current test is running on NPU0:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NPU: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Product name: STCP920</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Product brand: STREAMCOMPUTING</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Sn: 01PSF60000170610</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Chip count: 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Temperature:   33C</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        AlertTemperature:   90C</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ShutdownTemperature:   90C</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Status: on</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Power:   31W</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Cluster count: 4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Frequency: 1000M</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Bus: 0000:03:00.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Vendor: 23e2 Device: 0100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Current link speed: 16.0 GT/s PCIe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Max link speed: 16.0 GT/s PCIe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Current link width: 16</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Max link width: 16</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Write bytes: 0B</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">stc device voltage info vsoc:840 mv vmac:720 mv</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">stc device soc west frequency 1000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">stc device soc east frequency 1000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">stc device ddr frequency 3733</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">################################################################</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               STCP920 [thermal] TEST ON NPU0 BEGIN</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#################################################################</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="循环测试">循环测试<a href="#循环测试" class="hash-link" aria-label="Direct link to 循环测试" title="Direct link to 循环测试" translate="no">​</a></h4>
<p>循环执行5次PCIe带宽测试：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ ./system_prepare.sh 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Check numactl commands on this host...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Remove stcqual stc.ko ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Load stcdma.ko to kernel...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DONE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ ./stcqual --test 1 --loops 5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">stcqual version:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">stcqual version: v1.3.14</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">HOST SYSTEM INFO:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Architecture:                    x86_64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CPU op-mode(s):                  32-bit, 64-bit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Byte Order:                      Little Endian</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Address sizes:                   40 bits physical, 48 bits virtual</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CPU(s):                          8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">On-line CPU(s) list:             0-7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Thread(s) per core:              1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Core(s) per socket:              1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Socket(s):                       8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NUMA node(s):                    1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Vendor ID:                       AuthenticAMD</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CPU family:                      23</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Model:                           49</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Model name:                      AMD EPYC-Rome Processor</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Stepping:                        0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CPU MHz:                         2794.750</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">BogoMIPS:                        5589.50</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Virtualization:                  AMD-V</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Hypervisor vendor:               KVM</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Virtualization type:             full</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">L1d cache:                       256 KiB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">L1i cache:                       256 KiB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">L2 cache:                        4 MiB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">L3 cache:                        128 MiB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NUMA node0 CPU(s):               0-7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Vulnerability Itlb multihit:     Not affected</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Vulnerability L1tf:              Not affected</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Vulnerability Mds:               Not affected</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Vulnerability Meltdown:          Not affected</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Vulnerability Spec store bypass: Mitigation; Speculative Store Bypass disabled via prctl and seccomp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Vulnerability Spectre v1:        Mitigation; usercopy/swapgs barriers and __user pointer sanitization</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Vulnerability Spectre v2:        Mitigation; LFENCE, IBPB conditional, IBRS_FW, STIBP disabled, RSB filling</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Vulnerability Srbds:             Not affected</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Vulnerability Tsx async abort:   Not affected</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Flags:                           fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush mmx fxsr sse sse2 syscall nx mmxext fxsr_opt pdpe1gb rdtscp lm rep_good nopl cpuid extd_apicid tsc_known_freq pni pclmulqdq ssse3 fma cx16 sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand hypervisor lahf_lm cmp_legacy svm cr8_legacy abm sse4a misalignsse 3dnowprefetch osvw topoext perfctr_core ssbd ibrs ibpb stibp vmmcall fsgsbase tsc_adjust bmi1 avx2 smep bmi2 rdseed adx smap clflushopt clwb sha_ni xsaveopt xsavec xgetbv1 clzero xsaveerptr wbnoinvd arat npt nrip_save umip rdpid arch_capabilities</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Current test is running on NPU0:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">################################################################</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               STCP920 [pcie_bw] TEST ON NPU0 BEGIN</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#################################################################</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="在日志文件名中添加产品类型">在日志文件名中添加产品类型<a href="#在日志文件名中添加产品类型" class="hash-link" aria-label="Direct link to 在日志文件名中添加产品类型" title="Direct link to 在日志文件名中添加产品类型" translate="no">​</a></h4>
<p>在NPU 0上执行SLT测试，生成的日志文件名中包括产品类型：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ ./system_prepare.sh 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Remove stcdma.ko ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Load stcqual stc.ko to kernel...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DONE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ ./stcqual -t8 -i0 --prod_id stc920</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">stcqual version:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">stcqual version: v1.3.14</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">HOST SYSTEM INFO:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Architecture:                    x86_64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CPU op-mode(s):                  32-bit, 64-bit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Byte Order:                      Little Endian</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Address sizes:                   40 bits physical, 48 bits virtual</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CPU(s):                          8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">On-line CPU(s) list:             0-7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Thread(s) per core:              1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Core(s) per socket:              1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Socket(s):                       8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NUMA node(s):                    1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Vendor ID:                       AuthenticAMD</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CPU family:                      23</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Model:                           49</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Model name:                      AMD EPYC-Rome Processor</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Stepping:                        0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CPU MHz:                         2794.748</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">BogoMIPS:                        5589.49</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Virtualization:                  AMD-V</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Hypervisor vendor:               KVM</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Virtualization type:             full</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">L1d cache:                       256 KiB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">L1i cache:                       256 KiB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">L2 cache:                        4 MiB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">L3 cache:                        128 MiB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NUMA node0 CPU(s):               0-7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Vulnerability Itlb multihit:     Not affected</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Vulnerability L1tf:              Not affected</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Vulnerability Mds:               Not affected</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Vulnerability Meltdown:          Not affected</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Vulnerability Spec store bypass: Mitigation; Speculative Store Bypass disabled via prctl and seccomp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Vulnerability Spectre v1:        Mitigation; usercopy/swapgs barriers and __user pointer sanitization</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Vulnerability Spectre v2:        Mitigation; LFENCE, IBPB conditional, IBRS_FW, STIBP disabled, RSB filling</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Vulnerability Srbds:             Not affected</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Vulnerability Tsx async abort:   Not affected</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Flags:                           fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush mmx fxsr sse sse2 syscall nx mmxext fxsr_opt pdpe1gb rdtscp lm rep_good nopl cpuid extd_apicid tsc_known_freq pni pclmulqdq ssse3 fma cx16 sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand hypervisor lahf_lm cmp_legacy svm cr8_legacy abm sse4a misalignsse 3dnowprefetch osvw topoext perfctr_core ssbd ibrs ibpb stibp vmmcall fsgsbase tsc_adjust bmi1 avx2 smep bmi2 rdseed adx smap clflushopt clwb sha_ni xsaveopt xsavec xgetbv1 clzero xsaveerptr wbnoinvd arat npt nrip_save umip rdpid arch_capabilities</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Current test is running on NPU0:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NPU: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Product name: STCP920</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Product brand: STREAMCOMPUTING</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Sn: 01PSF60000170610</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Chip count: 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Temperature:   34C</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        AlertTemperature:   90C</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ShutdownTemperature:   90C</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Status: on</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Power:   31W</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Cluster count: 4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Frequency: 1000M</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Bus: 0000:03:00.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Vendor: 23e2 Device: 0100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Current link speed: 16.0 GT/s PCIe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Max link speed: 16.0 GT/s PCIe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Current link width: 16</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Max link width: 16</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Write bytes: 0B</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">stc device voltage info vsoc:840 mv vmac:720 mv</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">stc device soc west frequency 1000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">stc device soc east frequency 1000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">stc device ddr frequency 3733</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">################################################################</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               STCP920 [slt] TEST ON NPU0 BEGIN</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#################################################################</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span></code></pre></div></div>
<p>测试完成后，log目录下的日志文件名称示例为stcqual-slt-npu0-01PSF60000170610-stc920-202407231529.log。</p>
<blockquote>
<p>说明：SLT测试耗时约10分钟，回显信息也较多，因此示例仅展示部分回显信息。</p>
</blockquote>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="常见问题">常见问题<a href="#常见问题" class="hash-link" aria-label="Direct link to 常见问题" title="Direct link to 常见问题" translate="no">​</a></h3>
<ul>
<li>
<p>如果在切换驱动时出现以下报错，说明存在依赖HPE驱动的程序，请参考<em>使用流程</em>章节中的步骤排查。</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ ./system_prepare.sh 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Remove standard stc.ko ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rmmod: ERROR: Module stc is in use</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">### Failed to remove old stc.ko</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ ./system_prepare.sh 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Check numactl commands on this host...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Remove standard stc.ko ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rmmod: ERROR: Module stc is in use</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">### Failed to remove old stc.ko</span><br></span></code></pre></div></div>
</li>
<li>
<p>在指定PCI总线时，如果使用<code>./stcqual --list</code>得到的BUS-ID，无需包括末尾（例如<code>(00P8K2860206090d)</code>），否则会出现报错。</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$./stcqual --list</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NPU: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        STCP920         BUS-ID: 0:04:00.0 (00P8K2860206090d)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ ./stcqual --test 2 --pcibus 0:04:00.0 (00P8K2860206090d)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-bash: syntax error near unexpected token `(&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ lspci -d:0100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00:01.0 VGA compatible controller: Red Hat, Inc. QXL paravirtual graphic card (rev 04)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">04:00.0 Processing accelerators: Device 23e2:0100</span><br></span></code></pre></div></div>
</li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/希姆计算软件产品/STCRP使用指南/stcqual使用指南.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/希姆计算软件产品/STCRP使用指南/npu-exporter使用说明"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">npu-exporter使用说明</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/希姆计算软件产品/STCRP安装指南"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">STCRP安装指南</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#stcqual概述" class="table-of-contents__link toc-highlight">stcqual概述</a></li><li><a href="#使用stcqual测试npu设备" class="table-of-contents__link toc-highlight">使用stcqual测试NPU设备</a><ul><li><a href="#前提条件" class="table-of-contents__link toc-highlight">前提条件</a></li><li><a href="#使用流程" class="table-of-contents__link toc-highlight">使用流程</a></li><li><a href="#文件说明" class="table-of-contents__link toc-highlight">文件说明</a></li><li><a href="#命令说明" class="table-of-contents__link toc-highlight">命令说明</a></li><li><a href="#命令示例" class="table-of-contents__link toc-highlight">命令示例</a></li><li><a href="#常见问题" class="table-of-contents__link toc-highlight">常见问题</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/希姆计算术语表">希姆计算术语</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://x.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">X<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>